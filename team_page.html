<!DOCTYPE>
<html>
	<head>
		<meta  charset="utf-8" />
		<title>大富翁小學堂</title>
		<link rel='stylesheet' type="text/css" href="style/startstyle.css">
	</head>

	<body>
		<div>
			<canvas id="backgroundimg" class="cv" width="750" height="420"><p>Warning: 您的瀏覽器時髦值不夠，不能運行canvas </canvas>
			<canvas id="buttonimg" class="cv" width="750" height="420"> </canvas>
			<canvas id="touchfeel" class="cv" width="750" height="420"> </canvas>
		</div>
	</body>
</html>
<script>

var ctouchcheck=document.getElementById("touchfeel");
var ctcrk =ctouchcheck.getContext("2d"); 
var cbackground=document.getElementById("backgroundimg");
var cbg =cbackground.getContext("2d"); 
var cbutton=document.getElementById("buttonimg");
var cbtn =cbutton.getContext("2d"); 

var bimg=new Image();
bimg.src="../pic/main_page/team_page.jpg";
var MOUSE=
{
	limit:0,
	mx:0,
	my:0,
	click_check:false,
	getmousexy:function ()
	{
		this.mx=event.clientX;
		this.my=event.clientY;	
	}
};
var CHECK=
{
	cx:new Array(),
	cy:new Array(),
	cl:new Array(),
	cw:new Array(),
	cimg:new Array(),
	checkinfor:function()
	{
		this.cl[1]=136;
		this.cw[1]=88;
		this.cl[2]=157;	
		this.cw[2]=97;	
		this.cx[1]=1150;
		this.cy[1]=600;
		this.cl[0]=this.cl[1]*0.9;
		this.cw[0]=this.cw[1]*0.9;
		this.cx[2]=this.cx[1]-(this.cl[2]-this.cl[1])/2;
		this.cy[2]=this.cy[1]-(this.cw[2]-this.cw[1])/2;
		this.cx[0]=this.cx[1]+(this.cl[1]-this.cl[0])/2;
		this.cy[0]=this.cy[1]+(this.cw[1]-this.cw[0])/2;
	},
	checkdraw:function(check,bs)
	{
		cbtn.clearRect(this.cx[2],this.cy[2],this.cl[2],this.cw[2]);
		cbtn.drawImage(this.cimg[check],this.cx[bs],this.cy[bs],this.cl[bs],this.cw[bs]);
	}
};
var SETPAGE=
{
	check1:0,
	check2:0,
	volumex:0
};
var VOICEPLAY=
{
	played:false,
	pushed:false,
	playvoice:function(kind,msg)
	{
		var voice=document.getElementById("bgSound");
		if(SETPAGE.check2==0) voice.muted=true;
		else voice.muted=false;
		voice.volume=SETPAGE.volumex/100;
		switch(kind)
		{
			case 2:
				if(!VOICEPLAY.played)
				{
					voice.src="../voice/00"+kind+".mp3";
					voice.play();
					VOICEPLAY.played=true;
				}
				break;
			case 3:
				if(!VOICEPLAY.pushed)
				{
					voice.src="../voice/00"+kind+".mp3";
					voice.play();
					VOICEPLAY.pushed=true;
				}
				var a=setInterval(function()
				{
					if(voice.ended)
					{
						document.location.replace(encodeURI(msg));
clearInterval(a);
					}
				},10);
				break;
		}
	}
};
for(var i=0;i<2;i++)
{
	CHECK.cimg[i]=new Image();
	CHECK.cimg[i].src="../pic/main_page/back_"+(parseInt(i)+1)+".png";//679-417 788-484
}

window.onload=function()
{
	if(!havethechar(document.location.href,'?'))
	{
		alert("這裡不是開始頁喔XDDDD");
		good_bye();
	}
	getinfor();
	bgdraw();
	CHECK.checkinfor();
	CHECK.checkdraw(0,1);
	toucheventlistener();
}
function havethechar(check_arr,check)
{
	for(var i=0;i<check_arr.length;i++)
	{
		if(check_arr[i]==check)return true;
	}
	return false;
}
function inareaornot(mx,my,x1,y1,xs,ys)
{
	if(mx>=x1&&mx<=(x1+xs)&&my>=y1&&my<=(y1+ys))return true;
	return false;
}
function getinfor()
{
	var url=decodeURI(document.location.href);
	var a=url.split('?');
	var infor=a[1].split('&');
	var values=infor[0].split('$');
	SETPAGE.check1=values[0];
	SETPAGE.check2=values[1];
	SETPAGE.volumex=infor[1];
}
function toucheventlistener()
{
	ctouchcheck.addEventListener("mousemove",MouseMoveHandler,false);
	ctouchcheck.addEventListener("mousedown",MouseDownHandler,false);
	ctouchcheck.addEventListener("mouseup",MouseUpHandler,false);
	ctouchcheck.addEventListener("click",MouseClickHandler,false);
}
function MouseMoveHandler(event)
{
	MOUSE.getmousexy();
	if( inareaornot(MOUSE.mx,MOUSE.my,CHECK.cx[1],CHECK.cy[1],CHECK.cl[1],CHECK.cw[1]) )
	{
		if(!VOICEPLAY.pushed)VOICEPLAY.playvoice(2);
		if(MOUSE.click_check)return;
	}
	else
	{
		 MOUSE.click_check=false;
		 VOICEPLAY.played=false;
	}
	if(!VOICEPLAY.pushed)
	{
		if(inareaornot(MOUSE.mx,MOUSE.my,CHECK.cx[1],CHECK.cy[1],CHECK.cl[1],CHECK.cw[1])) CHECK.checkdraw(1,2);
		else CHECK.checkdraw(0,1);
	}
}
function MouseDownHandler(event)
{
	msg2=SETPAGE.check1+"$"+SETPAGE.check2+"&"+SETPAGE.volumex;
	MOUSE.getmousexy();
	if(inareaornot(MOUSE.mx,MOUSE.my,CHECK.cx[1],CHECK.cy[1],CHECK.cl[1],CHECK.cw[1])) MOUSE.click_check=true;
	else MOUSE.click_check=false; 
	if(VOICEPLAY.pushed)return;
	if(inareaornot(MOUSE.mx,MOUSE.my,CHECK.cx[1],CHECK.cy[1],CHECK.cl[1],CHECK.cw[1]))
	{
		 CHECK.checkdraw(1,0);
		 VOICEPLAY.playvoice(3,"start_page.html?team_page&"+msg2);
	}
	else CHECK.checkdraw(0,1);

}

function MouseUpHandler(event)
{
	MOUSE.click_check=false; 
}

function bgdraw()
{
	cbg.drawImage(bimg,0,0,1500,843);
}
 function good_bye()
  {
     alert("網頁發生異常錯誤!!即將關閉網站。");
 	 window.opener=null;
     window.close();
        }
</script>